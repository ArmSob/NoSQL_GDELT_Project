{"paragraphs":[{"text":"import sys.process._\nimport java.net.{URL, HttpURLConnection}\nimport java.nio.file.{Files,StandardCopyOption}\nimport java.io.File\n\nimport org.apache.spark.sql.types\nimport org.apache.spark.sql.Column\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.SQLContext\nimport org.apache.spark.input.PortableDataStream\nimport java.util.zip.ZipInputStream\nimport java.io.BufferedReader\nimport java.io.InputStreamReader\n\nimport com.amazonaws.services.s3.AmazonS3Client\nimport com.amazonaws.auth.BasicAWSCredentials\nimport com.amazonaws.auth.BasicSessionCredentials\n\nimport com.datastax.spark.connector.cql.CassandraConnector\nimport org.apache.spark.sql.cassandra._","user":"anonymous","dateUpdated":"2021-01-21T16:49:35+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646073_-2133873547","id":"20210108-143457_1719135930","dateCreated":"2021-01-21T16:14:06+0000","dateStarted":"2021-01-21T16:49:35+0000","dateFinished":"2021-01-21T16:49:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:14871","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import sys.process._\nimport java.net.{URL, HttpURLConnection}\nimport java.nio.file.{Files, StandardCopyOption}\nimport java.io.File\nimport org.apache.spark.sql.types\nimport org.apache.spark.sql.Column\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.SQLContext\nimport org.apache.spark.input.PortableDataStream\nimport java.util.zip.ZipInputStream\nimport java.io.BufferedReader\nimport java.io.InputStreamReader\nimport com.amazonaws.services.s3.AmazonS3Client\nimport com.amazonaws.auth.BasicAWSCredentials\nimport com.amazonaws.auth.BasicSessionCredentials\nimport com.datastax.spark.connector.cql.CassandraConnector\nimport org.apache.spark.sql.cassandra._\n"}]}},{"text":"// S3 bucket access configuration\n    \nval AWS_ID = \"ASIAZLK42DVGT4GOIQBD\"\nval AWS_KEY = \"Wqhvv/ish361rHTUMeSQXSou4DOUAtuSEjnJeE/2\"\nval AWS_SESSION_TOKEN = \"FwoGZXIvYXdzEOH//////////wEaDAmgNNlM7Fs+e96ihyLTAfaW7oUH4vb+WEsuIzOVqvanxv7SmRoITK739jILNHJFUX3Ccex4J9GjV5/yxRmPZxVnn+KAjjoWwmB2lgZ0P7A0pMPqhzgUzNZjwotdBFPCARYmg30Im2LSyQ3e5kRbMsNJvvIwHHkQM+nY9Hqzz4MQcvWQgeRqy9K5lZjflMRQjlcoAZ+igq5ru/uc5vh0kvhg3KYxXf9rD7Fa1RscY6c3sk+PIH0FVRUCOS8lA8Wf3hVm8U4YzvdXmY1y+SU/NfqLHMOfuHlHGsmGdB4hwpTAVsIo7rSmgAYyLQa01y09IHkaMjwCoM4+HNYthsRWK9Gw56OikbbmWZ6dSy6AqOrHpMTJbwqkug==\"\n\n@transient val awsClient = new AmazonS3Client(new BasicSessionCredentials(AWS_ID, AWS_KEY, AWS_SESSION_TOKEN))\n\nsc.hadoopConfiguration.set(\"fs.s3a.access.key\", AWS_ID)\nsc.hadoopConfiguration.set(\"fs.s3a.secret.key\", AWS_KEY)\nsc.hadoopConfiguration.set(\"fs.s3a.secret.token\", AWS_SESSION_TOKEN)","user":"anonymous","dateUpdated":"2021-01-21T16:49:38+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646073_317693559","id":"20210118-152913_1311267838","dateCreated":"2021-01-21T16:14:06+0000","dateStarted":"2021-01-21T16:49:38+0000","dateFinished":"2021-01-21T16:49:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14872","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\nAWS_ID: String = ASIAZLK42DVGT4GOIQBD\nAWS_KEY: String = Wqhvv/ish361rHTUMeSQXSou4DOUAtuSEjnJeE/2\nAWS_SESSION_TOKEN: String = FwoGZXIvYXdzEOH//////////wEaDAmgNNlM7Fs+e96ihyLTAfaW7oUH4vb+WEsuIzOVqvanxv7SmRoITK739jILNHJFUX3Ccex4J9GjV5/yxRmPZxVnn+KAjjoWwmB2lgZ0P7A0pMPqhzgUzNZjwotdBFPCARYmg30Im2LSyQ3e5kRbMsNJvvIwHHkQM+nY9Hqzz4MQcvWQgeRqy9K5lZjflMRQjlcoAZ+igq5ru/uc5vh0kvhg3KYxXf9rD7Fa1RscY6c3sk+PIH0FVRUCOS8lA8Wf3hVm8U4YzvdXmY1y+SU/NfqLHMOfuHlHGsmGdB4hwpTAVsIo7rSmgAYyLQa01y09IHkaMjwCoM4+HNYthsRWK9Gw56OikbbmWZ6dSy6AqOrHpMTJbwqkug==\nawsClient: com.amazonaws.services.s3.AmazonS3Client = com.amazonaws.services.s3.AmazonS3Client@3d8f0d4c\n"}]}},{"text":"// Points difficiles : Obtenir un RDD d'un ensemble de fichiers Zip. Une fois obtenu, on transforme les lignes en un unique Array de string via le split sur tab (\"\\t\"). La fonction split ne pouvant pas se faire sur un Dataframe.\n//                     On transforme ce RDD en Dataframe et une fois obtenu, on peut créer un second Dataframe ayant plusieurs colonnes en choisissant les éléments au sein de l'array du Dataframe initial.","user":"anonymous","dateUpdated":"2021-01-21T16:49:41+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646073_-1141557226","id":"20210116-164114_33209133","dateCreated":"2021-01-21T16:14:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14873","dateFinished":"2021-01-21T16:49:41+0000","dateStarted":"2021-01-21T16:49:41+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"// MENTIONS : Données en anglais + translingual\r\nval Mentions_RDD = sc.binaryFiles(\"s3://telecom-gdelt2020//20200615170000.mentions.CSV.zip\")\r\n    .flatMap { case (name: String, content: PortableDataStream) =>\r\n    val zis = new ZipInputStream(content.open)\r\n    Stream.continually(zis.getNextEntry)\r\n          .takeWhile(_ != null)\r\n          .flatMap { _ =>\r\n              val br = new BufferedReader(new InputStreamReader(zis))\r\n              Stream.continually(br.readLine()).takeWhile(_ != null)\r\n          }\r\n  }\r\nval Mentions_tmp = Mentions_RDD.map(x => x.split(\"\\t\")).toDF()   \r\n\r\n\r\n// EVENTS: Données en anglais + translingual\r\nval Events_RDD = sc.binaryFiles(\"s3://telecom-gdelt2020//20200615170000.export.CSV.zip\")\r\n   .flatMap { case (name: String, content: PortableDataStream) =>\r\n    val zis = new ZipInputStream(content.open)\r\n    Stream.continually(zis.getNextEntry)\r\n          .takeWhile(_ != null)\r\n          .flatMap { _ =>\r\n              val br = new BufferedReader(new InputStreamReader(zis))\r\n              Stream.continually(br.readLine()).takeWhile(_ != null)\r\n          }\r\n  }\r\nval Events_tmp = Events_RDD.map(x => x.split(\"\\t\")).toDF()\r\n\r\n\r\n// GKG : Données en anglais\r\nval Gkg_RDD = sc.binaryFiles(\"s3://telecom-gdelt2020//20200615170000.gkg.csv.zip\").\r\n  flatMap {  // decompresser les fichiers\r\n       case (name: String, content: PortableDataStream) =>\r\n          val zis = new ZipInputStream(content.open)\r\n          Stream.continually(zis.getNextEntry).\r\n                takeWhile{case null => zis.close(); false\r\n                       case _ => true}.\r\n                flatMap { _ =>\r\n                    val br = new BufferedReader(new InputStreamReader(zis))\r\n                    Stream.continually(br.readLine()).takeWhile(_ != null)\r\n                }\r\n    }\r\nval Gkg_tmp = Gkg_RDD.map(_.split(\"\\t\")).toDF()","user":"anonymous","dateUpdated":"2021-01-21T16:49:42+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646073_-1629950521","id":"20210116-150639_1909775654","dateCreated":"2021-01-21T16:14:06+0000","dateStarted":"2021-01-21T16:49:42+0000","dateFinished":"2021-01-21T16:49:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14874","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Mentions_RDD: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[152] at flatMap at <console>:77\nMentions_tmp: org.apache.spark.sql.DataFrame = [value: array<string>]\nEvents_RDD: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[155] at flatMap at <console>:91\nEvents_tmp: org.apache.spark.sql.DataFrame = [value: array<string>]\nGkg_RDD: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[158] at flatMap at <console>:105\nGkg_tmp: org.apache.spark.sql.DataFrame = [value: array<string>]\n"}]}},{"text":"// Utilisation du fichier Excel pour assigner le numéro aux colonnes pour trouver plus facilement + utilisation doc. Voir s'il ne faut pas plutôt mettre le nom de la colonne Big Query\n\n// Champs de la table events récupérés :\nval Events_DF_bis = Events_tmp.select(\n    $\"value\".getItem(0).as(\"globalevent_id\"),\n    $\"value\".getItem(1).as(\"year_month_day\"),\n    $\"value\".getItem(2).as(\"year_month\"),\n    $\"value\".getItem(3).as(\"year\"),\n    $\"value\".getItem(31).as(\"num_mention\"),\n    $\"value\".getItem(53).as(\"country\"),\n    $\"value\".getItem(60).as(\"source_url\")\n    )\n    \n    \n// Champs de la table Mentions récupérés :\nval Mentions_DF_bis = Mentions_tmp.select(\n    $\"value\".getItem(0).as(\"globalevent_id\"),\n    $\"value\".getItem(1).as(\"event_time_date\"),\n    $\"value\".getItem(2).as(\"mention_time_date\"),\n    $\"value\".getItem(5).as(\"mention_identifier\"),\n    $\"value\".getItem(14).as(\"article_language\")\n    )\n    \n// Champs de la table Gkg récupérés :  \nval Gkg_DF_bis = Gkg_tmp.select(\n    $\"value\".getItem(0).as(\"gkg_record_id\"), \n    //$\"value\".getItem(1).as(\"DATE\"),\n    $\"value\".getItem(3).as(\"source_common_name\"),\n    $\"value\".getItem(4).as(\"document_identifier\"),\n    $\"value\".getItem(7).as(\"themes\"),\n    $\"value\".getItem(9).as(\"locations\"),\n    $\"value\".getItem(11).as(\"persons\"),\n    $\"value\".getItem(15).as(\"tone\")\n    )\n   \n\n   \n","user":"anonymous","dateUpdated":"2021-01-21T17:18:03+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646073_1526632588","id":"20210116-165608_64288513","dateCreated":"2021-01-21T16:14:06+0000","dateStarted":"2021-01-21T17:18:03+0000","dateFinished":"2021-01-21T17:18:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14875","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Events_DF_bis: org.apache.spark.sql.DataFrame = [globalevent_id: string, year_month_day: string ... 5 more fields]\nMentions_DF_bis: org.apache.spark.sql.DataFrame = [globalevent_id: string, event_time_date: string ... 3 more fields]\nGkg_DF_bis: org.apache.spark.sql.DataFrame = [gkg_record_id: string, source_common_name: string ... 5 more fields]\n"}]}},{"text":"// Preprocessing de la colonne Day, MonthYear et NumMention pour Events      \nval Events_DF = Events_DF_bis.withColumn(\"num_mention\", Events_DF_bis(\"num_mention\").cast(\"Int\"))\n\n/*.withColumn(\"Day\", substring(col(\"Day\"), 7 , 2))    .withColumn(\"MonthYear\", substring(col(\"MonthYear\"), 5 , 2))*/\n\n// Preprocessing de la colonne Language pour Mentions\nval Mentions_DF = Mentions_DF_bis.withColumn(\"article_language\", when(col(\"article_language\").isNull, \"eng\").otherwise(substring_index(substring_index(col(\"article_language\"), \";\",1) , \":\", -1)))\n\n// Preprocessing de la colonne Locations et Tone pour Gkg\nval Gkg_DF_bis2 = Gkg_DF_bis.withColumn(\"locations\", when(col(\"locations\").isNull, \"\").otherwise(substring_index(substring_index(col(\"locations\"), \"#\", 2) , \"#\", -1))).withColumn(\"tone\", substring_index(col(\"tone\"), \",\" , 1))","user":"anonymous","dateUpdated":"2021-01-21T17:19:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646073_-2037503278","id":"20210117-232006_410460837","dateCreated":"2021-01-21T16:14:06+0000","dateStarted":"2021-01-21T17:19:46+0000","dateFinished":"2021-01-21T17:19:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14876","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Events_DF: org.apache.spark.sql.DataFrame = [globalevent_id: string, year_month_day: string ... 5 more fields]\nMentions_DF: org.apache.spark.sql.DataFrame = [globalevent_id: string, event_time_date: string ... 3 more fields]\nGkg_DF_bis2: org.apache.spark.sql.DataFrame = [gkg_record_id: string, source_common_name: string ... 5 more fields]\n"}]}},{"text":"// Preprocessing de la colonne Tone pour Gkg\nval Gkg_DF = Gkg_DF_bis2.withColumn(\"tone\", Gkg_DF_bis2(\"tone\").cast(\"float\"))","user":"anonymous","dateUpdated":"2021-01-21T17:19:47+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646074_358855519","id":"20210117-232658_2020609674","dateCreated":"2021-01-21T16:14:06+0000","dateStarted":"2021-01-21T17:19:47+0000","dateFinished":"2021-01-21T17:19:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14877","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Gkg_DF: org.apache.spark.sql.DataFrame = [gkg_record_id: string, source_common_name: string ... 5 more fields]\n"}]}},{"text":"//Question n°1 : Afficher le nombre d’articles/évènements qui parlent de COVID qu’il y a eu pour chaque triplet (jour, pays de l’évènement, langue de l’article).","user":"anonymous","dateUpdated":"2021-01-21T17:19:50+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646074_1875490388","id":"20210120-104445_1992967672","dateCreated":"2021-01-21T16:14:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14881","dateFinished":"2021-01-21T17:19:50+0000","dateStarted":"2021-01-21T17:19:50+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"val Q1_Gkg_int = Gkg_DF.filter($\"themes\".like(\"%CORONAVIRUS%\"))","user":"anonymous","dateUpdated":"2021-01-21T17:19:52+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646074_1450252100","id":"20210120-104428_956455872","dateCreated":"2021-01-21T16:14:06+0000","dateStarted":"2021-01-21T17:19:52+0000","dateFinished":"2021-01-21T17:19:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14882","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Q1_Gkg_int: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [gkg_record_id: string, source_common_name: string ... 5 more fields]\n"}]}},{"text":"val Q1_Mentions_join = Mentions_DF.join(Q1_Gkg_int, $\"mention_identifier\" === $\"document_identifier\")","user":"anonymous","dateUpdated":"2021-01-21T16:51:25+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646074_1810753188","id":"20210120-104459_942962624","dateCreated":"2021-01-21T16:14:06+0000","dateStarted":"2021-01-21T16:51:25+0000","dateFinished":"2021-01-21T16:51:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14883","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Q1_Mentions_join: org.apache.spark.sql.DataFrame = [globalevent_id: string, event_time_date: string ... 10 more fields]\n"}]}},{"text":"val Q1_Events_join = Events_DF.join(Q1_Mentions_join, \"globalevent_id\")","user":"anonymous","dateUpdated":"2021-01-21T16:51:29+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646074_-2141580364","id":"20210120-104510_975793916","dateCreated":"2021-01-21T16:14:06+0000","dateStarted":"2021-01-21T16:51:29+0000","dateFinished":"2021-01-21T16:51:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14884","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Q1_Events_join: org.apache.spark.sql.DataFrame = [globalevent_id: string, year_month_day: string ... 16 more fields]\n"}]}},{"text":"val Q1_Table1 = Q1_Events_join.select($\"globalevent_id\", $\"year_month_day\", $\"country\", $\"article_language\")","user":"anonymous","dateUpdated":"2021-01-21T16:52:21+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646075_-1685996038","id":"20210120-104523_886672388","dateCreated":"2021-01-21T16:14:06+0000","dateStarted":"2021-01-21T16:51:30+0000","dateFinished":"2021-01-21T16:51:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14885","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Q1_Table1: org.apache.spark.sql.DataFrame = [globalevent_id: string, year_month_day: string ... 2 more fields]\n"}]}},{"text":"Q1_Table1.show()","user":"anonymous","dateUpdated":"2021-01-21T16:51:33+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=42","http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=43","http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=44","http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=47"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1611245646075_-691377392","id":"20210120-105406_1517884102","dateCreated":"2021-01-21T16:14:06+0000","dateStarted":"2021-01-21T16:51:33+0000","dateFinished":"2021-01-21T16:51:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14886","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+--------------+-------+----------------+\n|globalevent_id|year_month_day|country|article_language|\n+--------------+--------------+-------+----------------+\n|     929511274|      20200615|     US|             eng|\n|     929511219|      20200615|     US|             eng|\n|     929510276|      20200615|     US|             eng|\n|     929510738|      20200615|     UK|             eng|\n|     929510835|      20200615|     NI|             eng|\n|     929510138|      20200615|     NI|             eng|\n|     929510137|      20200615|     NI|             eng|\n|     929510121|      20200615|     NI|             eng|\n|     929510120|      20200615|     NI|             eng|\n|     929510114|      20200615|     NI|             eng|\n|     929510113|      20200615|     NI|             eng|\n|     929510610|      20200615|     IR|             eng|\n|     929510609|      20200615|     IR|             eng|\n|     929510607|      20200615|     IS|             eng|\n|     929510596|      20200615|     AU|             eng|\n|     929510595|      20200615|     IR|             eng|\n|     929510556|      20200615|     AU|             eng|\n|     929511003|      20200615|     TU|             eng|\n|     929511002|      20200615|     TU|             eng|\n|     929511000|      20200615|     TU|             eng|\n+--------------+--------------+-------+----------------+\nonly showing top 20 rows\n\n"}]}},{"text":"CassandraConnector(sc.getConf).withSessionDo { session =>\n      session.execute(\n          \"\"\"\n             DROP KEYSPACE IF EXISTS gdelt;\n          \"\"\"\n          )\n      session.execute(\n          \"\"\"\n             CREATE KEYSPACE IF NOT EXISTS gdelt\n             WITH REPLICATION = {'class': 'SimpleStrategy', 'replication_factor': 3 };\n          \"\"\")\n          session.execute(\n          \"\"\"\n             CREATE TABLE IF NOT EXISTS gdelt.q1(\n                globalevent_id text,\n                year_month_day text,\n                country text,\n                article_language text,\n             PRIMARY KEY (globalevent_id));\n          \"\"\"\n        )\n}\n\nQ1_Table1.write\n      .cassandraFormat(\"q1\", \"gdelt\")\n      .mode(org.apache.spark.sql.SaveMode.Overwrite)\n      .options(Map(\"confirm.truncate\" -> \"true\"))\n      .save()\n      \nval q1 = spark.read\n      .cassandraFormat(\"q1\", \"gdelt\")\n      .load()\n      \nq1.createOrReplaceTempView(\"view_q1\")","user":"anonymous","dateUpdated":"2021-01-21T17:07:08+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=91","http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=92","http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=93","http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=96"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1611245895872_-1218430846","id":"20210121-161815_359641024","dateCreated":"2021-01-21T16:18:15+0000","dateStarted":"2021-01-21T17:07:08+0000","dateFinished":"2021-01-21T17:07:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14887","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"q1: org.apache.spark.sql.DataFrame = [globalevent_id: string, article_language: string ... 2 more fields]\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"article_language":"string","events_number":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611247985865_79002008","id":"20210121-165305_2140318502","dateCreated":"2021-01-21T16:53:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:17911","text":"//Question n°1 : Afficher le nombre d’articles/évènements qui parlent de COVID qu’il y a eu pour chaque triplet (jour, pays de l’évènement, langue de l’article).\n\nz.show(spark.sql(\"\"\" SELECT count(globalevent_id) as article_language, count(DISTINCT globalevent_id) as events_number  FROM view_q1 WHERE year_month_day = '20200615' AND country = 'US' AND article_language = 'eng' \"\"\"))","dateUpdated":"2021-01-21T17:07:42+0000","dateFinished":"2021-01-21T17:07:48+0000","dateStarted":"2021-01-21T17:07:43+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"article_language\tevents_number\n206\t206\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=97","http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=98","http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=99"],"interpreterSettingId":"spark"}}},{"text":"//Question n°2 : Pour un pays donné en paramètre, affichez les évènements qui y ont eu place triées par le nombre de mentions (tri décroissant); permettez une agrégation par jour/mois/année.","user":"anonymous","dateUpdated":"2021-01-21T16:14:06+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646075_1613140341","id":"20210120-104629_724578307","dateCreated":"2021-01-21T16:14:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14890"},{"text":"val Q2_Events_join = Events_DF.join(Mentions_DF, \"globalevent_id\").drop(Mentions_DF.col(\"globalevent_id\"))","user":"anonymous","dateUpdated":"2021-01-21T17:02:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646075_790162395","id":"20210120-121356_1947707485","dateCreated":"2021-01-21T16:14:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14891","dateFinished":"2021-01-21T17:02:14+0000","dateStarted":"2021-01-21T17:02:14+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Q2_Events_join: org.apache.spark.sql.DataFrame = [globalevent_id: string, year_month_day: string ... 9 more fields]\n"}]}},{"text":"val Q2_Table2 = Q2_Events_join.select($\"globalevent_id\", $\"year_month_day\", $\"year_month\", $\"year\", $\"country\", $\"mention_identifier\")","user":"anonymous","dateUpdated":"2021-01-21T17:05:19+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646075_-1038434121","id":"20210120-121408_1100641782","dateCreated":"2021-01-21T16:14:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14892","dateFinished":"2021-01-21T17:05:19+0000","dateStarted":"2021-01-21T17:05:19+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Q2_Table2: org.apache.spark.sql.DataFrame = [globalevent_id: string, year_month_day: string ... 4 more fields]\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611248588575_-1285301252","id":"20210121-170308_334309977","dateCreated":"2021-01-21T17:03:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20377","text":"Q2_Table2.show()","dateUpdated":"2021-01-21T17:05:21+0000","dateFinished":"2021-01-21T17:05:29+0000","dateStarted":"2021-01-21T17:05:21+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+--------------+----------+----+-------+--------------------+\n|globalevent_id|year_month_day|year_month|year|country|  mention_identifier|\n+--------------+--------------+----------+----+-------+--------------------+\n|     929510085|      20200615|    202006|2020|     US|https://www.green...|\n|     929510085|      20200615|    202006|2020|     US|https://www.green...|\n|     929510085|      20200615|    202006|2020|     US|https://www.green...|\n|     929510412|      20200615|    202006|2020|     US|https://slate.com...|\n|     929510783|      20200615|    202006|2020|     US|https://tucson.co...|\n|     929510285|      20200615|    202006|2020|     GH|https://xbitgh.co...|\n|     929510285|      20200615|    202006|2020|     GH|https://ghanavibe...|\n|     929510753|      20200615|    202006|2020|     US|http://www.piloto...|\n|     929510943|      20200615|    202006|2020|     US|https://www.alter...|\n|     929511301|      20200615|    202006|2020|     RS|https://www.ndtv....|\n|     929511326|      20200615|    202006|2020|     US|https://www.medsc...|\n|     929510703|      20200615|    202006|2020|     JE|https://www.njher...|\n|     929510757|      20200615|    202006|2020|     CA|https://www.contx...|\n|     929509988|      20200615|    202006|2020|       |https://globalnew...|\n|     929510183|      20200615|    202006|2020|     CS|https://ticotimes...|\n|     929511235|      20200615|    202006|2020|     US|https://www2.ljwo...|\n|     929509973|      20200615|    202006|2020|     US|https://kelo.com/...|\n|     929511249|      20200615|    202006|2020|     IT|https://www.gq-ma...|\n|     929511140|      20200615|    202006|2020|     US|https://www.green...|\n|     929510269|      20200615|    202006|2020|     US|https://www.syrac...|\n+--------------+--------------+----------+----+-------+--------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=87","http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=88","http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=90"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611248305669_-586420765","id":"20210121-165825_725635974","dateCreated":"2021-01-21T16:58:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:18594","text":"CassandraConnector(sc.getConf).withSessionDo { session =>\n      session.execute(\n          \"\"\"\n             CREATE KEYSPACE IF NOT EXISTS gdelt\n             WITH REPLICATION = {'class': 'SimpleStrategy', 'replication_factor': 3 };\n          \"\"\")\n          session.execute(\n          \"\"\"\n             CREATE TABLE IF NOT EXISTS gdelt.q2(\n                globalevent_id text,\n                year_month_day text,\n                year_month text,\n                year text,\n                country text,\n                mention_identifier text,\n             PRIMARY KEY ((globalevent_id, mention_identifier)));\n          \"\"\"\n        )\n}\n\nQ2_Table2.write\n      .cassandraFormat(\"q2\", \"gdelt\")\n      .mode(org.apache.spark.sql.SaveMode.Overwrite)\n      .options(Map(\"confirm.truncate\" -> \"true\"))\n      .save()\n      \nval q2 = spark.read\n      .cassandraFormat(\"q2\", \"gdelt\")\n      .load()\n      \nq2.createOrReplaceTempView(\"view_q2\")","dateUpdated":"2021-01-21T17:11:05+0000","dateFinished":"2021-01-21T17:11:23+0000","dateStarted":"2021-01-21T17:11:05+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"q2: org.apache.spark.sql.DataFrame = [globalevent_id: string, mention_identifier: string ... 4 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=109","http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=110","http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=112"],"interpreterSettingId":"spark"}}},{"text":"val Pays : String = \"'US'\"","user":"anonymous","dateUpdated":"2021-01-21T17:11:39+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646076_345880505","id":"20210120-121428_125747140","dateCreated":"2021-01-21T16:14:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14894","dateFinished":"2021-01-21T17:11:39+0000","dateStarted":"2021-01-21T17:11:39+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Pays: String = 'US'\n"}]}},{"text":"\r\n\r\nz.show(spark.sql(s\"\"\" SELECT country, year_month, globalevent_id, count(\"globalevent_id\") as number_mentions FROM view_q2 WHERE country = $Pays GROUP BY year_month, country, globalevent_id ORDER BY count(\"globalevent_id\") DESC \"\"\"))\r\n\r\n/* Attention aggregation par jour à prévoir --> Number_Mentions déjà créée + sum sur cette colonne */","user":"anonymous","dateUpdated":"2021-01-21T17:13:06+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"country":"string","year_month":"string","globalevent_id":"string","number_mentions":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646076_1435636425","id":"20210120-121439_245112495","dateCreated":"2021-01-21T16:14:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14895","dateFinished":"2021-01-21T17:13:06+0000","dateStarted":"2021-01-21T17:12:54+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"country\tyear_month\tglobalevent_id\tnumber_mentions\nUS\t202006\t929510276\t10\nUS\t202006\t929511219\t9\nUS\t202006\t929510088\t5\nUS\t202006\t929511398\t5\nUS\t202006\t929511315\t5\nUS\t202006\t929511346\t5\nUS\t202006\t929511336\t5\nUS\t202006\t929510074\t5\nUS\t202006\t929511390\t4\nUS\t202006\t929510752\t4\nUS\t202006\t929511397\t4\nUS\t202006\t929510166\t3\nUS\t202006\t929510087\t3\nUS\t201906\t929509565\t3\nUS\t202006\t929511142\t3\nUS\t201906\t929509566\t3\nUS\t202006\t929509658\t3\nUS\t202006\t929509663\t3\nUS\t202006\t929510060\t3\nUS\t202006\t929510085\t3\nUS\t202006\t929511338\t2\nUS\t202006\t929510897\t2\nUS\t202006\t929511184\t2\nUS\t202006\t929510096\t2\nUS\t202006\t929511341\t2\nUS\t202006\t929510478\t2\nUS\t202006\t929511105\t2\nUS\t202006\t929510097\t2\nUS\t202006\t929511125\t2\nUS\t202006\t929511308\t2\nUS\t202006\t929510518\t2\nUS\t202006\t929511342\t2\nUS\t202006\t929511195\t2\nUS\t202006\t929511183\t2\nUS\t202006\t929511337\t2\nUS\t202006\t929511309\t2\nUS\t202006\t929510165\t2\nUS\t202006\t929510145\t2\nUS\t202006\t929511017\t2\nUS\t202006\t929510893\t2\nUS\t202006\t929511343\t2\nUS\t202006\t929510098\t2\nUS\t202006\t929510099\t2\nUS\t202006\t929511381\t2\nUS\t202006\t929509668\t1\nUS\t202006\t929511094\t1\nUS\t202006\t929510751\t1\nUS\t202006\t929511228\t1\nUS\t202006\t929510053\t1\nUS\t202006\t929511358\t1\nUS\t202006\t929511067\t1\nUS\t202006\t929511073\t1\nUS\t202006\t929511107\t1\nUS\t202006\t929509967\t1\nUS\t202006\t929509655\t1\nUS\t202006\t929509766\t1\nUS\t202006\t929509680\t1\nUS\t202006\t929511154\t1\nUS\t202006\t929511135\t1\nUS\t202006\t929510504\t1\nUS\t202006\t929511375\t1\nUS\t202006\t929509716\t1\nUS\t202006\t929510051\t1\nUS\t202006\t929511396\t1\nUS\t202006\t929511085\t1\nUS\t202006\t929510055\t1\nUS\t202006\t929511084\t1\nUS\t202006\t929510635\t1\nUS\t202006\t929509652\t1\nUS\t202006\t929510204\t1\nUS\t202006\t929511092\t1\nUS\t202006\t929510955\t1\nUS\t202006\t929510058\t1\nUS\t202006\t929511345\t1\nUS\t202006\t929510764\t1\nUS\t202006\t929510211\t1\nUS\t202006\t929509835\t1\nUS\t202006\t929510200\t1\nUS\t202006\t929511386\t1\nUS\t202006\t929511404\t1\nUS\t202006\t929509691\t1\nUS\t202006\t929510163\t1\nUS\t202006\t929509703\t1\nUS\t202006\t929510483\t1\nUS\t202006\t929509744\t1\nUS\t202006\t929510169\t1\nUS\t202006\t929511437\t1\nUS\t202006\t929511058\t1\nUS\t202006\t929510254\t1\nUS\t202006\t929511046\t1\nUS\t202006\t929510252\t1\nUS\t202006\t929509781\t1\nUS\t202006\t929511241\t1\nUS\t202006\t929511340\t1\nUS\t202006\t929511242\t1\nUS\t202006\t929509788\t1\nUS\t202006\t929510157\t1\nUS\t202006\t929510329\t1\nUS\t202006\t929509910\t1\nUS\t202006\t929510957\t1\nUS\t202006\t929511379\t1\nUS\t202006\t929511197\t1\nUS\t202006\t929511178\t1\nUS\t202006\t929509645\t1\nUS\t202006\t929511093\t1\nUS\t202006\t929509749\t1\nUS\t202006\t929511028\t1\nUS\t202006\t929511074\t1\nUS\t202006\t929511049\t1\nUS\t202006\t929510184\t1\nUS\t202006\t929511033\t1\nUS\t202006\t929511207\t1\nUS\t202006\t929510255\t1\nUS\t202006\t929511101\t1\nUS\t202006\t929510521\t1\nUS\t202006\t929509765\t1\nUS\t202006\t929511282\t1\nUS\t202006\t929509661\t1\nUS\t202006\t929509647\t1\nUS\t202006\t929510479\t1\nUS\t202006\t929511440\t1\nUS\t202006\t929511087\t1\nUS\t202006\t929510146\t1\nUS\t202006\t929511164\t1\nUS\t202006\t929511169\t1\nUS\t202006\t929511175\t1\nUS\t202006\t929511158\t1\nUS\t202006\t929510086\t1\nUS\t202006\t929510139\t1\nUS\t202006\t929509779\t1\nUS\t202006\t929509774\t1\nUS\t202006\t929510711\t1\nUS\t202006\t929509790\t1\nUS\t202006\t929511380\t1\nUS\t202006\t929511287\t1\nUS\t202006\t929509692\t1\nUS\t202006\t929510429\t1\nUS\t202006\t929510158\t1\nUS\t202006\t929510188\t1\nUS\t202006\t929510781\t1\nUS\t202006\t929510189\t1\nUS\t202006\t929511362\t1\nUS\t202006\t929510269\t1\nUS\t202006\t929511365\t1\nUS\t202006\t929511439\t1\nUS\t202006\t929510140\t1\nUS\t202006\t929511361\t1\nUS\t202006\t929511176\t1\nUS\t202006\t929511273\t1\nUS\t202006\t929511064\t1\nUS\t202006\t929510777\t1\nUS\t202006\t929509929\t1\nUS\t202006\t929511325\t1\nUS\t202006\t929511239\t1\nUS\t202006\t929510156\t1\nUS\t202006\t929509738\t1\nUS\t202006\t929510666\t1\nUS\t202006\t929509947\t1\nUS\t202006\t929511202\t1\nUS\t202006\t929510801\t1\nUS\t202006\t929511095\t1\nUS\t202006\t929511116\t1\nUS\t202006\t929510288\t1\nUS\t202006\t929510104\t1\nUS\t202006\t929511364\t1\nUS\t202006\t929510322\t1\nUS\t202006\t929511347\t1\nUS\t202006\t929511218\t1\nUS\t202006\t929510171\t1\nUS\t202006\t929510173\t1\nUS\t202006\t929510270\t1\nUS\t202006\t929510782\t1\nUS\t202006\t929510122\t1\nUS\t202006\t929511370\t1\nUS\t202006\t929511321\t1\nUS\t202006\t929511068\t1\nUS\t202006\t929509911\t1\nUS\t202006\t929511159\t1\nUS\t202006\t929511402\t1\nUS\t202006\t929511039\t1\nUS\t202006\t929511072\t1\nUS\t202006\t929509741\t1\nUS\t202006\t929511026\t1\nUS\t202006\t929511215\t1\nUS\t202006\t929511052\t1\nUS\t202006\t929510896\t1\nUS\t202006\t929510080\t1\nUS\t202006\t929511378\t1\nUS\t202006\t929510062\t1\nUS\t202006\t929511236\t1\nUS\t202006\t929511331\t1\nUS\t202006\t929511150\t1\nUS\t202006\t929511383\t1\nUS\t202006\t929510651\t1\nUS\t202006\t929511057\t1\nUS\t202006\t929511319\t1\nUS\t202006\t929511400\t1\nUS\t202006\t929509709\t1\nUS\t202006\t929509624\t1\nUS\t202006\t929511185\t1\nUS\t202006\t929511203\t1\nUS\t202006\t929509795\t1\nUS\t202006\t929511204\t1\nUS\t202006\t929511223\t1\nUS\t202006\t929510798\t1\nUS\t202006\t929509743\t1\nUS\t202006\t929511024\t1\nUS\t202006\t929510446\t1\nUS\t202006\t929511130\t1\nUS\t202006\t929509732\t1\nUS\t202006\t929509953\t1\nUS\t202006\t929511103\t1\nUS\t202006\t929511233\t1\nUS\t202006\t929510261\t1\nUS\t202006\t929510892\t1\nUS\t202006\t929509818\t1\nUS\t202006\t929510277\t1\nUS\t202006\t929510956\t1\nUS\t202006\t929510501\t1\nUS\t202006\t929511232\t1\nUS\t202006\t929511348\t1\nUS\t202006\t929509776\t1\nUS\t202006\t929510147\t1\nUS\t202006\t929510243\t1\nUS\t202006\t929511350\t1\nUS\t202006\t929511141\t1\nUS\t202006\t929511133\t1\nUS\t202006\t929511339\t1\nUS\t202006\t929511231\t1\nUS\t202006\t929511226\t1\nUS\t202006\t929511210\t1\nUS\t202006\t929511250\t1\nUS\t202006\t929510089\t1\nUS\t202006\t929510669\t1\nUS\t202006\t929511312\t1\nUS\t202006\t929509786\t1\nUS\t202006\t929510102\t1\nUS\t202006\t929510613\t1\nUS\t202006\t929510124\t1\nUS\t202006\t929511021\t1\nUS\t202006\t929511220\t1\nUS\t202006\t929511127\t1\nUS\t202006\t929511299\t1\nUS\t202006\t929511389\t1\nUS\t202006\t929510492\t1\nUS\t202006\t929510433\t1\nUS\t202006\t929510164\t1\nUS\t202006\t929510477\t1\nUS\t202006\t929510750\t1\nUS\t202006\t929509775\t1\nUS\t202006\t929511199\t1\nUS\t202006\t929510090\t1\nUS\t202006\t929510106\t1\nUS\t202006\t929511172\t1\nUS\t202006\t929511357\t1\nUS\t202006\t929510935\t1\nUS\t202006\t929510671\t1\nUS\t202006\t929510943\t1\nUS\t202006\t929510958\t1\nUS\t202006\t929510235\t1\nUS\t202006\t929510634\t1\nUS\t202006\t929511374\t1\nUS\t202006\t929511330\t1\nUS\t202006\t929511359\t1\nUS\t202006\t929510152\t1\nUS\t202006\t929509852\t1\nUS\t202006\t929511170\t1\nUS\t202006\t929509798\t1\nUS\t202006\t929511382\t1\nUS\t202006\t929511335\t1\nUS\t202006\t929509855\t1\nUS\t202006\t929510778\t1\nUS\t202006\t929511263\t1\nUS\t202006\t929509833\t1\nUS\t202006\t929510180\t1\nUS\t202006\t929510714\t1\nUS\t202006\t929509965\t1\nUS\t202006\t929511181\t1\nUS\t202006\t929510181\t1\nUS\t202006\t929510894\t1\nUS\t202006\t929509752\t1\nUS\t202006\t929509762\t1\nUS\t202006\t929510052\t1\nUS\t202006\t929509782\t1\nUS\t202006\t929511237\t1\nUS\t202006\t929509653\t1\nUS\t202006\t929511043\t1\nUS\t202006\t929511324\t1\nUS\t202006\t929510709\t1\nUS\t202006\t929511034\t1\nUS\t202006\t929511054\t1\nUS\t202006\t929511216\t1\nUS\t202006\t929510194\t1\nUS\t202006\t929510523\t1\nUS\t202006\t929511111\t1\nUS\t202006\t929509639\t1\nUS\t202006\t929509683\t1\nUS\t202006\t929511100\t1\nUS\t202006\t929509927\t1\nUS\t202006\t929511291\t1\nUS\t202006\t929511134\t1\nUS\t202006\t929511234\t1\nUS\t202006\t929509767\t1\nUS\t202006\t929511190\t1\nUS\t202006\t929511071\t1\nUS\t202006\t929510776\t1\nUS\t202006\t929511377\t1\nUS\t202006\t929510168\t1\nUS\t202006\t929511447\t1\nUS\t202006\t929511441\t1\nUS\t202006\t929509966\t1\nUS\t202006\t929509646\t1\nUS\t202006\t929511356\t1\nUS\t202006\t929511153\t1\nUS\t202006\t929509754\t1\nUS\t202006\t929509961\t1\nUS\t202006\t929510701\t1\nUS\t202006\t929509780\t1\nUS\t202006\t929510437\t1\nUS\t202006\t929510259\t1\nUS\t202006\t929511097\t1\nUS\t202006\t929509698\t1\nUS\t202006\t929509753\t1\nUS\t202006\t929510539\t1\nUS\t202006\t929510730\t1\nUS\t202006\t929510076\t1\nUS\t202006\t929509936\t1\nUS\t202006\t929509784\t1\nUS\t202006\t929510670\t1\nUS\t202006\t929510430\t1\nUS\t202006\t929509791\t1\nUS\t202006\t929511139\t1\nUS\t202006\t929511117\t1\nUS\t202006\t929509777\t1\nUS\t202006\t929509660\t1\nUS\t202006\t929511317\t1\nUS\t202006\t929509640\t1\nUS\t202006\t929509621\t1\nUS\t202006\t929511354\t1\nUS\t202006\t929509693\t1\nUS\t202006\t929511196\t1\nUS\t202006\t929511387\t1\nUS\t202006\t929511268\t1\nUS\t202006\t929511020\t1\nUS\t202006\t929511047\t1\nUS\t202006\t929509974\t1\nUS\t202006\t929509916\t1\nUS\t202006\t929511434\t1\nUS\t202006\t929511438\t1\nUS\t202006\t929509823\t1\nUS\t202006\t929511372\t1\nUS\t202006\t929511349\t1\nUS\t202006\t929511369\t1\nUS\t202006\t929511360\t1\nUS\t202006\t929511156\t1\nUS\t202006\t929511320\t1\nUS\t202006\t929510533\t1\nUS\t202006\t929511076\t1\nUS\t202006\t929510700\t1\nUS\t202006\t929509746\t1\nUS\t202006\t929510485\t1\nUS\t202006\t929509958\t1\nUS\t202006\t929509728\t1\nUS\t202006\t929510725\t1\nUS\t202006\t929509764\t1\nUS\t202006\t929510426\t1\nUS\t202006\t929511145\t1\nUS\t202006\t929511385\t1\nUS\t202006\t929510780\t1\nUS\t202006\t929511075\t1\nUS\t202006\t929511023\t1\nUS\t202006\t929510874\t1\nUS\t202006\t929509751\t1\nUS\t202006\t929510508\t1\nUS\t202006\t929511045\t1\nUS\t202006\t929511352\t1\nUS\t202005\t929509577\t1\nUS\t202006\t929510699\t1\nUS\t202006\t929509641\t1\nUS\t202006\t929511171\t1\nUS\t202006\t929511240\t1\nUS\t202006\t929509755\t1\nUS\t202006\t929511271\t1\nUS\t202006\t929511011\t1\nUS\t202006\t929510273\t1\nUS\t202006\t929510298\t1\nUS\t202006\t929509789\t1\nUS\t202006\t929511051\t1\nUS\t202006\t929509613\t1\nUS\t202006\t929510945\t1\nUS\t202006\t929511082\t1\nUS\t202006\t929510702\t1\nUS\t202006\t929509731\t1\nUS\t202006\t929510753\t1\nUS\t202006\t929509689\t1\nUS\t202006\t929511314\t1\nUS\t202006\t929511194\t1\nUS\t202006\t929510647\t1\nUS\t202006\t929510650\t1\nUS\t202006\t929511201\t1\nUS\t202006\t929511147\t1\nUS\t202006\t929509768\t1\nUS\t202006\t929511106\t1\nUS\t202006\t929511102\t1\nUS\t202006\t929510280\t1\nUS\t202006\t929510878\t1\nUS\t202006\t929511166\t1\nUS\t202006\t929509628\t1\nUS\t202006\t929509757\t1\nUS\t202006\t929510482\t1\nUS\t202006\t929511177\t1\nUS\t202006\t929510193\t1\nUS\t202006\t929509742\t1\nUS\t202006\t929509834\t1\nUS\t202006\t929511373\t1\nUS\t202006\t929510078\t1\nUS\t202006\t929510155\t1\nUS\t202006\t929511310\t1\nUS\t202006\t929509897\t1\nUS\t202006\t929511155\t1\nUS\t202006\t929511089\t1\nUS\t202006\t929511098\t1\nUS\t202006\t929509610\t1\nUS\t202006\t929511368\t1\nUS\t202006\t929510153\t1\nUS\t202006\t929509686\t1\nUS\t202006\t929511318\t1\nUS\t202006\t929510648\t1\nUS\t202006\t929511140\t1\nUS\t202006\t929510535\t1\nUS\t202006\t929511062\t1\nUS\t202006\t929510799\t1\nUS\t202006\t929511019\t1\nUS\t202006\t929510925\t1\nUS\t202006\t929510237\t1\nUS\t202006\t929510696\t1\nUS\t202006\t929509609\t1\nUS\t202006\t929509667\t1\nUS\t202006\t929509959\t1\nUS\t202006\t929510105\t1\nUS\t202006\t929509759\t1\nUS\t202006\t929510488\t1\nUS\t202006\t929511187\t1\nUS\t202006\t929510944\t1\nUS\t202006\t929511167\t1\nUS\t202006\t929509869\t1\nUS\t202006\t929511279\t1\nUS\t202006\t929510319\t1\nUS\t202006\t929511245\t1\nUS\t202006\t929509750\t1\nUS\t202006\t929509704\t1\nUS\t202006\t929509745\t1\nUS\t202006\t929511193\t1\nUS\t201906\t929509569\t1\nUS\t202006\t929511160\t1\nUS\t202006\t929511285\t1\nUS\t202006\t929511222\t1\nUS\t202006\t929511302\t1\nUS\t202006\t929509817\t1\nUS\t202006\t929511161\t1\nUS\t202006\t929510656\t1\nUS\t202006\t929511056\t1\nUS\t202006\t929511227\t1\nUS\t202006\t929510205\t1\nUS\t202006\t929509677\t1\nUS\t202006\t929509783\t1\nUS\t202006\t929511128\t1\nUS\t202006\t929511290\t1\nUS\t202006\t929510481\t1\nUS\t202006\t929510783\t1\nUS\t202006\t929510116\t1\nUS\t202006\t929511288\t1\nUS\t202006\t929510412\t1\nUS\t202006\t929510946\t1\nUS\t202006\t929510737\t1\nUS\t202006\t929509793\t1\nUS\t202006\t929510094\t1\nUS\t202006\t929510209\t1\nUS\t202006\t929510519\t1\nUS\t202006\t929510151\t1\nUS\t202006\t929510092\t1\nUS\t202006\t929510144\t1\nUS\t202006\t929509950\t1\nUS\t202006\t929511112\t1\nUS\t202006\t929509904\t1\nUS\t202006\t929511198\t1\nUS\t202006\t929511289\t1\nUS\t202006\t929510275\t1\nUS\t202006\t929509650\t1\nUS\t202006\t929511334\t1\nUS\t202006\t929510898\t1\nUS\t202006\t929509931\t1\nUS\t202006\t929511191\t1\nUS\t202006\t929510082\t1\nUS\t202006\t929509773\t1\nUS\t202006\t929511059\t1\nUS\t202006\t929510161\t1\nUS\t202006\t929511275\t1\nUS\t202006\t929511391\t1\nUS\t202006\t929511079\t1\nUS\t202006\t929511274\t1\nUS\t202006\t929509787\t1\nUS\t202006\t929511214\t1\nUS\t202006\t929510057\t1\nUS\t202006\t929509964\t1\nUS\t202006\t929511269\t1\nUS\t202006\t929511146\t1\nUS\t202006\t929509960\t1\nUS\t202006\t929511206\t1\nUS\t202006\t929511192\t1\nUS\t202006\t929510148\t1\nUS\t202006\t929511283\t1\nUS\t202006\t929510779\t1\nUS\t202006\t929511311\t1\nUS\t202006\t929511083\t1\nUS\t202006\t929511260\t1\nUS\t202006\t929511259\t1\nUS\t202006\t929509912\t1\nUS\t202006\t929511048\t1\nUS\t202006\t929511229\t1\nUS\t202006\t929510258\t1\nUS\t202006\t929511180\t1\nUS\t202006\t929510698\t1\nUS\t202006\t929510160\t1\nUS\t202006\t929511351\t1\nUS\t202006\t929510079\t1\nUS\t202006\t929511162\t1\nUS\t202006\t929510895\t1\nUS\t202006\t929509707\t1\nUS\t202006\t929509824\t1\nUS\t202006\t929510212\t1\nUS\t202006\t929510493\t1\nUS\t202006\t929511265\t1\nUS\t202006\t929511077\t1\nUS\t202006\t929510487\t1\nUS\t202006\t929510774\t1\nUS\t202006\t929511217\t1\nUS\t202006\t929511221\t1\nUS\t202006\t929511036\t1\nUS\t202006\t929511108\t1\nUS\t202006\t929509972\t1\nUS\t202006\t929511277\t1\nUS\t202006\t929510332\t1\nUS\t202006\t929510490\t1\nUS\t202006\t929509736\t1\nUS\t202006\t929511211\t1\nUS\t202006\t929511280\t1\nUS\t202006\t929509642\t1\nUS\t202006\t929511278\t1\nUS\t202006\t929510203\t1\nUS\t202006\t929510432\t1\nUS\t202006\t929509659\t1\nUS\t202006\t929510271\t1\nUS\t202006\t929510236\t1\nUS\t202006\t929509699\t1\nUS\t202006\t929510891\t1\nUS\t202006\t929511264\t1\nUS\t202006\t929510172\t1\nUS\t202006\t929511086\t1\nUS\t202006\t929511272\t1\nUS\t202006\t929511115\t1\nUS\t202006\t929511286\t1\nUS\t202006\t929511323\t1\nUS\t202006\t929511063\t1\nUS\t202006\t929509760\t1\nUS\t202006\t929511031\t1\nUS\t201906\t929509570\t1\nUS\t202006\t929510293\t1\nUS\t202006\t929509794\t1\nUS\t202006\t929510423\t1\nUS\t202006\t929510875\t1\nUS\t202006\t929511209\t1\nUS\t202005\t929509591\t1\nUS\t202006\t929510431\t1\nUS\t202006\t929510201\t1\nUS\t202006\t929511266\t1\nUS\t202006\t929509638\t1\nUS\t202006\t929509721\t1\nUS\t202006\t929511109\t1\nUS\t202006\t929511088\t1\nUS\t202006\t929511376\t1\nUS\t202006\t929510202\t1\nUS\t202006\t929510484\t1\nUS\t202006\t929511212\t1\nUS\t202006\t929511018\t1\nUS\t202006\t929510077\t1\nUS\t202006\t929511129\t1\nUS\t202006\t929511138\t1\nUS\t202006\t929511050\t1\nUS\t202006\t929511099\t1\nUS\t202006\t929510489\t1\nUS\t202006\t929509771\t1\nUS\t202006\t929510199\t1\nUS\t202006\t929509832\t1\nUS\t202006\t929511061\t1\nUS\t202006\t929509971\t1\nUS\t202006\t929509785\t1\nUS\t202006\t929511436\t1\nUS\t202006\t929511244\t1\nUS\t202006\t929509922\t1\nUS\t202006\t929510419\t1\nUS\t202006\t929511137\t1\nUS\t202006\t929511168\t1\nUS\t202006\t929511037\t1\nUS\t202006\t929511070\t1\nUS\t202006\t929511205\t1\nUS\t202006\t929510739\t1\nUS\t202006\t929510162\t1\nUS\t202006\t929509761\t1\nUS\t202006\t929510727\t1\nUS\t202006\t929511041\t1\nUS\t202006\t929511151\t1\nUS\t202006\t929510667\t1\nUS\t202006\t929510084\t1\nUS\t202006\t929511179\t1\nUS\t202006\t929509963\t1\nUS\t202006\t929510073\t1\nUS\t202006\t929510661\t1\nUS\t202006\t929511152\t1\nUS\t202006\t929511281\t1\nUS\t202006\t929511055\t1\nUS\t202006\t929511132\t1\nUS\t202006\t929510977\t1\nUS\t202006\t929511258\t1\nUS\t202006\t929510748\t1\nUS\t202006\t929509733\t1\nUS\t202006\t929511213\t1\nUS\t202006\t929510272\t1\nUS\t202006\t929510069\t1\nUS\t202006\t929509921\t1\nUS\t202006\t929510506\t1\nUS\t202006\t929511136\t1\nUS\t202006\t929511173\t1\nUS\t202006\t929511306\t1\nUS\t202006\t929510806\t1\nUS\t202006\t929510065\t1\nUS\t202006\t929509648\t1\nUS\t202006\t929511292\t1\nUS\t202006\t929511066\t1\nUS\t202006\t929510416\t1\nUS\t202006\t929511298\t1\nUS\t202006\t929511313\t1\nUS\t202006\t929511305\t1\nUS\t202006\t929510642\t1\nUS\t202006\t929509649\t1\nUS\t202006\t929509763\t1\nUS\t202006\t929511157\t1\nUS\t202006\t929511124\t1\nUS\t202006\t929511044\t1\nUS\t202006\t929510213\t1\nUS\t202006\t929509644\t1\nUS\t202006\t929511326\t1\nUS\t202006\t929510159\t1\nUS\t202006\t929509970\t1\nUS\t202006\t929510797\t1\nUS\t202006\t929510260\t1\nUS\t202006\t929511174\t1\nUS\t202006\t929511355\t1\nUS\t202006\t929510170\t1\nUS\t202006\t929511403\t1\nUS\t202006\t929511035\t1\nUS\t202006\t929511016\t1\nUS\t202006\t929511081\t1\nUS\t202006\t929511262\t1\nUS\t202006\t929509612\t1\nUS\t202006\t929511090\t1\nUS\t202006\t929511270\t1\nUS\t201906\t929509564\t1\nUS\t202006\t929510663\t1\nUS\t202006\t929511333\t1\nUS\t202006\t929511110\t1\nUS\t202006\t929510807\t1\nUS\t202006\t929510061\t1\nUS\t202006\t929510534\t1\nUS\t202006\t929511118\t1\nUS\t202006\t929511144\t1\nUS\t202006\t929510071\t1\nUS\t202006\t929510538\t1\nUS\t202006\t929511123\t1\nUS\t202006\t929510227\t1\nUS\t202006\t929511276\t1\nUS\t202006\t929511363\t1\nUS\t202006\t929510056\t1\nUS\t202006\t929511235\t1\nUS\t202006\t929510404\t1\nUS\t202006\t929511053\t1\nUS\t202006\t929509797\t1\nUS\t202006\t929510342\t1\nUS\t202006\t929511267\t1\nUS\t202006\t929510769\t1\nUS\t202006\t929511322\t1\nUS\t202006\t929511435\t1\nUS\t202006\t929511367\t1\nUS\t202006\t929510664\t1\nUS\t202006\t929510149\t1\nUS\t202006\t929510208\t1\nUS\t202006\t929509756\t1\nUS\t202006\t929511030\t1\nUS\t202006\t929510274\t1\nUS\t202006\t929511032\t1\nUS\t202006\t929510502\t1\nUS\t202006\t929510292\t1\nUS\t202006\t929511224\t1\nUS\t202006\t929511293\t1\nUS\t202006\t929509718\t1\nUS\t202006\t929509948\t1\nUS\t202006\t929511027\t1\nUS\t202006\t929510524\t1\nUS\t202006\t929510649\t1\nUS\t202006\t929509962\t1\nUS\t202006\t929510659\t1\nUS\t202006\t929510091\t1\nUS\t202006\t929510279\t1\nUS\t202006\t929511040\t1\nUS\t202006\t929510775\t1\nUS\t202006\t929509769\t1\nUS\t202006\t929511143\t1\nUS\t202006\t929511122\t1\nUS\t202006\t929510198\t1\nUS\t202006\t929511065\t1\nUS\t202006\t929509705\t1\nUS\t202006\t929510873\t1\nUS\t202006\t929511131\t1\nUS\t202006\t929511069\t1\nUS\t202006\t929510081\t1\nUS\t202006\t929509758\t1\nUS\t202006\t929510436\t1\nUS\t202006\t929510406\t1\nUS\t202006\t929509675\t1\nUS\t202006\t929510728\t1\nUS\t202006\t929510267\t1\nUS\t202006\t929510756\t1\nUS\t202006\t929509792\t1\nUS\t202006\t929511120\t1\nUS\t202006\t929510697\t1\nUS\t202006\t929511208\t1\nUS\t202006\t929510743\t1\nUS\t202006\t929510788\t1\nUS\t202006\t929509656\t1\nUS\t202006\t929511388\t1\nUS\t202006\t929509954\t1\nUS\t202006\t929510174\t1\nUS\t202006\t929511230\t1\nUS\t202006\t929511080\t1\nUS\t202006\t929511189\t1\nUS\t202006\t929511121\t1\nUS\t202006\t929511025\t1\nUS\t202006\t929511353\t1\nUS\t202006\t929511186\t1\nUS\t202006\t929510093\t1\nUS\t202006\t929510064\t1\nUS\t202006\t929510175\t1\nUS\t202006\t929510154\t1\nUS\t202006\t929511182\t1\nUS\t202006\t929510899\t1\nUS\t202006\t929511114\t1\nUS\t202006\t929511399\t1\nUS\t202006\t929510167\t1\nUS\t202006\t929511042\t1\nUS\t202006\t929510726\t1\nUS\t202006\t929510486\t1\nUS\t202006\t929510675\t1\nUS\t202006\t929510238\t1\nUS\t202006\t929511294\t1\nUS\t202006\t929511091\t1\nUS\t202006\t929510402\t1\nUS\t202006\t929511261\t1\nUS\t202006\t929509973\t1\nUS\t202006\t929509770\t1\nUS\t202006\t929510765\t1\nUS\t202006\t929511104\t1\nUS\t202006\t929510749\t1\nUS\t202006\t929511238\t1\nUS\t202005\t929509590\t1\nUS\t202006\t929511060\t1\nUS\t202006\t929510639\t1\nUS\t202006\t929510150\t1\nUS\t202006\t929511295\t1\nUS\t202006\t929510795\t1\nUS\t202006\t929510059\t1\nUS\t202006\t929510931\t1\nUS\t202006\t929509778\t1\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=113","http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=114"],"interpreterSettingId":"spark"}}},{"text":"\n\n//Question n°3 : Pour une source de donnés passée en paramètre (gkg.SourceCommonName) affichez les thèmes, personnes, lieux dont les articles de cette sources parlent ainsi que le nombre d’articles et le ton moyen des   articles (pour chaque thème/personne/lieu); permettez une agrégation par jour/mois/année.","user":"anonymous","dateUpdated":"2021-01-21T17:13:17+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646076_-906142648","id":"20210120-121451_144004224","dateCreated":"2021-01-21T16:14:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14896","dateFinished":"2021-01-21T17:13:17+0000","dateStarted":"2021-01-21T17:13:17+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"\n\nval Q3_Mentions_DF = Mentions_DF.withColumn(\"year_month_day\", substring(col(\"event_time_date\"), 1 , 8)).withColumn(\"year_month\", substring(col(\"event_time_date\"), 1 , 6)).withColumn(\"year\", substring(col(\"event_time_date\"), 1 , 4))","user":"anonymous","dateUpdated":"2021-01-21T17:20:02+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646077_-1913915415","id":"20210120-121514_2121744273","dateCreated":"2021-01-21T16:14:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14897","dateFinished":"2021-01-21T17:20:02+0000","dateStarted":"2021-01-21T17:20:02+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Q3_Mentions_DF: org.apache.spark.sql.DataFrame = [globalevent_id: string, event_time_date: string ... 6 more fields]\n"}]}},{"text":"val Q3_Table3 = Gkg_DF.join(Q3_Mentions_DF, $\"mention_identifier\" === $\"document_identifier\").drop($\"mention_identifier\")","user":"anonymous","dateUpdated":"2021-01-21T17:20:03+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646077_1996738583","id":"20210120-121530_783685090","dateCreated":"2021-01-21T16:14:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14898","dateFinished":"2021-01-21T17:20:03+0000","dateStarted":"2021-01-21T17:20:03+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Q3_Table3: org.apache.spark.sql.DataFrame = [gkg_record_id: string, source_common_name: string ... 12 more fields]\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611249379720_1158647524","id":"20210121-171619_918303213","dateCreated":"2021-01-21T17:16:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:22913","text":"Q3_Table3.show()","dateUpdated":"2021-01-21T17:20:04+0000","dateFinished":"2021-01-21T17:20:13+0000","dateStarted":"2021-01-21T17:20:04+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+--------------------+--------------------+--------------------+--------------------+--------------------+----------+--------------+---------------+-----------------+----------------+--------------+----------+----+\n|      gkg_record_id|  source_common_name| document_identifier|              themes|           locations|             persons|      tone|globalevent_id|event_time_date|mention_time_date|article_language|year_month_day|year_month|year|\n+-------------------+--------------------+--------------------+--------------------+--------------------+--------------------+----------+--------------+---------------+-----------------+----------------+--------------+----------+----+\n| 20200615170000-480|ironmountaindaily...|https://www.ironm...|TAX_DISEASE;TAX_D...|Montana, United S...|lamar alexander;t...| 0.4985045|     929417280| 20200615073000|   20200615170000|             eng|      20200615|    202006|2020|\n| 20200615170000-480|ironmountaindaily...|https://www.ironm...|TAX_DISEASE;TAX_D...|Montana, United S...|lamar alexander;t...| 0.4985045|     929511274| 20200615170000|   20200615170000|             eng|      20200615|    202006|2020|\n| 20200615170000-480|ironmountaindaily...|https://www.ironm...|TAX_DISEASE;TAX_D...|Montana, United S...|lamar alexander;t...| 0.4985045|     929380977| 20200615010000|   20200615170000|             eng|      20200615|    202006|2020|\n| 20200615170000-480|ironmountaindaily...|https://www.ironm...|TAX_DISEASE;TAX_D...|Montana, United S...|lamar alexander;t...| 0.4985045|     929382703| 20200615013000|   20200615170000|             eng|      20200615|    202006|2020|\n| 20200615170000-480|ironmountaindaily...|https://www.ironm...|TAX_DISEASE;TAX_D...|Montana, United S...|lamar alexander;t...| 0.4985045|     929388547| 20200615023000|   20200615170000|             eng|      20200615|    202006|2020|\n| 20200615170000-480|ironmountaindaily...|https://www.ironm...|TAX_DISEASE;TAX_D...|Montana, United S...|lamar alexander;t...| 0.4985045|     929454707| 20200615114500|   20200615170000|             eng|      20200615|    202006|2020|\n| 20200615170000-480|ironmountaindaily...|https://www.ironm...|TAX_DISEASE;TAX_D...|Montana, United S...|lamar alexander;t...| 0.4985045|     929382344| 20200615013000|   20200615170000|             eng|      20200615|    202006|2020|\n| 20200615170000-480|ironmountaindaily...|https://www.ironm...|TAX_DISEASE;TAX_D...|Montana, United S...|lamar alexander;t...| 0.4985045|     929388083| 20200615023000|   20200615170000|             eng|      20200615|    202006|2020|\n| 20200615170000-480|ironmountaindaily...|https://www.ironm...|TAX_DISEASE;TAX_D...|Montana, United S...|lamar alexander;t...| 0.4985045|     929387721| 20200615023000|   20200615170000|             eng|      20200615|    202006|2020|\n| 20200615170000-480|ironmountaindaily...|https://www.ironm...|TAX_DISEASE;TAX_D...|Montana, United S...|lamar alexander;t...| 0.4985045|     929387712| 20200615023000|   20200615170000|             eng|      20200615|    202006|2020|\n| 20200615170000-407|         deseret.com|https://www.deser...|EPU_POLICY;EPU_PO...|       United States|        george floyd|-2.1329987|     929373337| 20200615001500|   20200615170000|             eng|      20200615|    202006|2020|\n| 20200615170000-407|         deseret.com|https://www.deser...|EPU_POLICY;EPU_PO...|       United States|        george floyd|-2.1329987|     929371876| 20200615000000|   20200615170000|             eng|      20200615|    202006|2020|\n| 20200615170000-407|         deseret.com|https://www.deser...|EPU_POLICY;EPU_PO...|       United States|        george floyd|-2.1329987|     929509656| 20200615170000|   20200615170000|             eng|      20200615|    202006|2020|\n| 20200615170000-248|          cnc3.co.tt|https://www.cnc3....|TAX_FNCACT;TAX_FN...|Sangre Grande, Sa...|                    |-0.6329114|     929388833| 20200615021500|   20200615170000|             eng|      20200615|    202006|2020|\n| 20200615170000-248|          cnc3.co.tt|https://www.cnc3....|TAX_FNCACT;TAX_FN...|Sangre Grande, Sa...|                    |-0.6329114|     929388833| 20200615021500|   20200615170000|             eng|      20200615|    202006|2020|\n|20200615170000-1856|     forbesindia.com|HTTPS://www.forbe...|TAX_FNCACT;TAX_FN...|               India|      pankaj vermani| -5.900621|     929510674| 20200615170000|   20200615170000|             eng|      20200615|    202006|2020|\n|20200615170000-2030|       etftrends.com|https://www.etftr...|ECON_BITCOIN;WB_1...|                    |                    |-0.2570694|     929372657| 20200615001500|   20200615170000|             eng|      20200615|    202006|2020|\n| 20200615170000-909|     vanguardngr.com|https://www.vangu...|TAX_ETHNICITY;TAX...|Port Harcourt, Ri...|kayode fayemi;wik...|-4.6153846|     929510831| 20200615170000|   20200615170000|             eng|      20200615|    202006|2020|\n| 20200615170000-909|     vanguardngr.com|https://www.vangu...|TAX_ETHNICITY;TAX...|Port Harcourt, Ri...|kayode fayemi;wik...|-4.6153846|     929510827| 20200615170000|   20200615170000|             eng|      20200615|    202006|2020|\n|20200615170000-1962|      bedfordnow.com|https://www.bedfo...|USPEC_UNCERTAINTY...|New York, United ...|samuel alito;gera...|-1.7021277|     929500161| 20200615160000|   20200615170000|             eng|      20200615|    202006|2020|\n+-------------------+--------------------+--------------------+--------------------+--------------------+--------------------+----------+--------------+---------------+-----------------+----------------+--------------+----------+----+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=123","http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=124","http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=126"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611249332756_42727067","id":"20210121-171532_1432193521","dateCreated":"2021-01-21T17:15:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:22841","text":"CassandraConnector(sc.getConf).withSessionDo { session =>\n      session.execute(\n          \"\"\"\n             CREATE KEYSPACE IF NOT EXISTS gdelt\n             WITH REPLICATION = {'class': 'SimpleStrategy', 'replication_factor': 3 };\n          \"\"\")\n          session.execute(\n          \"\"\"\n             CREATE TABLE IF NOT EXISTS gdelt.q3(\n                gkg_record_id text,\n                source_common_name text,\n                document_identifier text,\n                themes text,\n                locations text,\n                persons text,\n                tone double,\n                globalevent_id text,\n                event_time_date text,\n                mention_time_date text,\n                article_language text,\n                year_month_day text,\n                year_month text,\n                year text,\n             PRIMARY KEY ((gkg_record_id, document_identifier, mention_time_date)));\n          \"\"\"\n        )\n}\n\nQ3_Table3.write\n      .cassandraFormat(\"q3\", \"gdelt\")\n      .mode(org.apache.spark.sql.SaveMode.Overwrite)\n      .options(Map(\"confirm.truncate\" -> \"true\"))\n      .save()\n      \nval q3 = spark.read\n      .cassandraFormat(\"q3\", \"gdelt\")\n      .load()\n      \nq3.createOrReplaceTempView(\"view_q3\")","dateUpdated":"2021-01-21T17:28:38+0000","dateFinished":"2021-01-21T17:28:42+0000","dateStarted":"2021-01-21T17:28:38+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"q3: org.apache.spark.sql.DataFrame = [gkg_record_id: string, mention_time_date: string ... 12 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=133","http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=134","http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=136"],"interpreterSettingId":"spark"}}},{"text":"val Source : String = \"'deseret.com'\"","user":"anonymous","dateUpdated":"2021-01-21T17:29:08+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646077_2038150933","id":"20210120-121712_1385500682","dateCreated":"2021-01-21T16:14:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14900","dateFinished":"2021-01-21T17:29:08+0000","dateStarted":"2021-01-21T17:29:08+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Source: String = 'deseret.com'\n"}]}},{"text":"//Question n°3 : Pour une source de donnés passée en paramètre (gkg.SourceCommonName) affichez les thèmes, personnes, lieux dont les articles de cette sources parlent ainsi que le nombre d’articles et le ton moyen des               articles (pour chaque thème/personne/lieu); permettez une agrégation par jour/mois/année.\n\nz.show(spark.sql(s\"\"\"  SELECT source_common_name,  year_month, themes, persons, locations, count(source_common_name) as article_language, mean(Tone) as mean_tone_articles FROM view_q3 WHERE source_common_name == $Source GROUP BY source_common_name,  year_month, themes, persons, locations  \"\"\"))","user":"anonymous","dateUpdated":"2021-01-21T17:29:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"source_common_name","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"year_month","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"themes","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"persons","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"locations","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"article_language","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"mean_tone_articles","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"source_common_name":"string","year_month":"string","themes":"string","persons":"string","locations":"string","article_language":"string","mean_tone_articles":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646077_1239693473","id":"20210120-121714_183699933","dateCreated":"2021-01-21T16:14:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14901","dateFinished":"2021-01-21T17:29:13+0000","dateStarted":"2021-01-21T17:29:12+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"source_common_name\tyear_month\tthemes\tpersons\tlocations\tarticle_language\tmean_tone_articles\ndeseret.com\t202006\tEPU_POLICY;EPU_POLICY_POLITICAL;GENERAL_HEALTH;HEALTH_PANDEMIC;WB_635_PUBLIC_HEALTH;WB_2165_HEALTH_EMERGENCIES;WB_2166_HEALTH_EMERGENCY_PREPAREDNESS_AND_DISASTER_RESPONSE;WB_621_HEALTH_NUTRITION_AND_POPULATION;WB_2167_PANDEMICS;UNGP_HEALTHCARE;EPU_ECONOMY;EPU_ECONOMY_HISTORIC;CRISISLEX_CRISISLEXREC;ECON_BUDGET_DEFICIT;SOC_GENERALCRIME;DISCRIMINATION;DISCRIMINATION_RACE;DISCRIMINATION_RACE_RACISM;UNGP_FREEDOM_FROM_DISCRIMINATION;MANMADE_DISASTER_IMPLIED;CRISISLEX_T11_UPDATESSYMPATHY;EDUCATION;SOC_POINTSOFINTEREST;SOC_POINTSOFINTEREST_SCHOOLS;TAX_WORLDMAMMALS;TAX_WORLDMAMMALS_HUMAN;LEADER;TAX_FNCACT;TAX_FNCACT_POLITICIANS;GENERAL_GOVERNMENT;EPU_POLICY_GOVERNMENT;TAX_FNCACT_OFFICIALS;TAX_FNCACT_EXECUTIVE;ELECTION;WB_695_POVERTY;INEQUALITY;LEGISLATION;EPU_POLICY_LAW;SECURITY_SERVICES;WB_696_PUBLIC_SECTOR_MANAGEMENT;WB_840_JUSTICE;WB_1920_FINANCIAL_SECTOR_DEVELOPMENT;WB_328_FINANCIAL_INTEGRITY;WB_1014_CRIMINAL_JUSTICE;WB_2082_LAW_ENFORCEMENT;USPEC_UNCERTAINTY1;TAX_ETHNICITY;TAX_ETHNICITY_AMERICANS;PROTEST;GRIEVANCES;TAX_FNCACT_POLICE;CRISISLEX_C07_SAFETY;TAX_FNCACT_OFFICERS;UNGP_FORESTS_RIVERS_OCEANS;TAX_FNCACT_CITIZENS;TAX_FNCACT_NOBLE;SOC_EMERGINGTECH;\tgeorge floyd\tUnited States\t1\t-2.1329987049102783\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=139","http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=140","http://ip-172-31-74-205.ec2.internal:4040/jobs/job?id=141"],"interpreterSettingId":"spark"}}},{"text":"//Question n°4 : Est-ce qu’on observe des patterns dans l’evolution qui pourraient nous permettre d’identifier la prochaine vague/pandemie.","user":"anonymous","dateUpdated":"2021-01-21T16:14:06+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646078_-1142084350","id":"20210120-121754_890031053","dateCreated":"2021-01-21T16:14:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14902"},{"text":"val Question4_DF = spark.sql(\"SELECT Day, MonthYear, Year, ArticleLanguage, ActionGeo_CountryCode as Country, count(Events.Globaleventid) as ArticlesNumber, count(DISTINCT Events.Globaleventid) as EventsNumber  FROM Events LEFT JOIN Mentions ON Events.Globaleventid = Mentions.Globaleventid WHERE Mentions.MentionIdentifier IN (SELECT DocumentIdentifier FROM Gkg WHERE Themes LIKE '%CORONAVIRUS%') AND ActionGeo_CountryCode = 'UK' AND ArticleLanguage = 'eng' GROUP BY Day, MonthYear, Year, ArticleLanguage, ActionGeo_CountryCode, ArticleLanguage ORDER BY ArticlesNumber DESC\")\nQuestion4_DF.show()\n","user":"anonymous","dateUpdated":"2021-01-21T16:14:06+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646078_-1039167387","id":"20210120-122941_1311574012","dateCreated":"2021-01-21T16:14:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14903"},{"text":"val Question4_DF2 = spark.sql(\"SELECT Day, MonthYear, Year, ActionGeo_CountryCode as Country, mean(Tone) as MeanToneArticles, count(Globaleventid) as ArticlesNumber FROM Join WHERE Themes LIKE '%CORONAVIRUS%' GROUP BY Day, MonthYear, Year, ActionGeo_CountryCode ORDER BY count(Globaleventid) DESC\")\n    Question4_DF2.show()","user":"anonymous","dateUpdated":"2021-01-21T16:14:06+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611245646078_1106345499","id":"20210120-122946_1098125021","dateCreated":"2021-01-21T16:14:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14904"}],"name":"PreparationData_Requetes_AWS","id":"2FY83NTQM","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}